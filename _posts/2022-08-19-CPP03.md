---
layout: post
author: Younji Kim
---

상속과 다형성에 대해서 연습하는 CPP03에 대한 내용 정리.

## Table of contents
- [Table of contents](#table-of-contents)
- [타입캐스팅](#타입캐스팅)
- [가상 상속에 관해](#가상-상속에-관해)

## [가상 상속에 관해](#가상-상속에-관해)
C++에서는 다중 상속을 지원한다. 다중상속은 장점도 있는 반면, 단점도 있다. 대표적으로, 상속성을 높여 더욱 유연하고 효율적인 코드를 짤 수 있다는 게 장점인 반면, 그와 동시에 하나의 클래스가 다른 클래스에 상속이 되고, 서로 꼬리에 꼬리를 무는 뫼비우스의 띠 같은 다이아몬드 상속구조를 가질 수도 있다는 것이다. 이는 메모리 낭비와 성능 저하로 이어지기 때문에 각별한 주의가 필요하다.<br>
이런 다이아몬드 상속의 구조를 띄게 될 경우, 데이터의 중복과 불필요한 생성자 호출을 막기 위해 virtual inheritance(가상 상속)을 사용한다.<br>
가상 상속을 하게 될 경우 vbptr(virtual base table pointer)이라는 offset을 가르키는 포인터가 생성되며, virtual로 상속된 클래스는 메모리 구조에서 제일 아래로 가게 된다. <br>
시작 offset은 0이 될 수도 있고 음수도 될 수 있다. 가상 상속은 기존 데이터 크기보다 더 커질 수 있으며, 성능 저하를 야기할 수 있다.

출처: https://hwan-shell.tistory.com/224